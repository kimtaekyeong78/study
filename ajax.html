<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
	<title>javascript</title>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
	<link crossorigin="anonymous" media="all" rel="stylesheet" href="/assets/scss/common.css" />
	<script type="text/javascript">

		// JQUERY AJAX
		$(document).on('ready', function(){
			
			let param1 = 20211001; // 서버로 보내야할 데이터 1
			let param2 = 13; // 서버로 보내야할 데이터 2

			try{
				$.ajax({
					url: `http://data.ex.co.kr/openapi/restinfo/restWeatherList?key=test&type=json&sdate=${param1}&stdHour=${param2}`,
					method: 'GET',
					async: true,
					dataType: 'json',
					success : function (response) {

						var _weatherHTML = ''
						
						for(var key in response.list) {
							
							function getToday(){
								var year = response.list[key].sdate.slice(0, 4) + '년';
								var month = response.list[key].sdate.slice(4, 6) + '월';
								var day = response.list[key].sdate.slice(6, 8) + '일';

								return year + month + day;
							}

							_weatherHTML += '<ul>';
							_weatherHTML += '<li>'+ response.list[key].unitName +'</li>';
							_weatherHTML += '<li>날짜: '+ getToday() +' &nbsp; '+ response.list[key].stdHour +'시</li>';
							_weatherHTML += '<li>고속도로 : '+ response.list[key].routeName +'</li>';
							_weatherHTML += '<li>휴게소 주소 : '+ response.list[key].addr +'</li>';
							_weatherHTML += '<li>날씨상태 : '+ response.list[key].weatherContents +'</li>';
							_weatherHTML += '</ul>';

							//console.log(key);
							//console.log(response.list[key]);

						}

						document.querySelector("#ajaxWrap").innerHTML = _weatherHTML;
					},
					error: function (xhr) {
						alert(xhr)
					}
					
				});
			}
			catch(e){
				//AJAX 로드 실패
				alert(e)
			}
			
		})
		

	</script>
</head>
<body>
	
	<div id="test">

		<div id="ajaxWrap">
			<h1>휴게소 날씨 상황</h1>
			<div id="listWrap"></div>
		</div>

	</div>
    

</body>
</html>